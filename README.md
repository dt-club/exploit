# Exploit 1.2 CS1.5 服务器防炸模块源代码

1. dlfile 下载文件导致服务器卡顿漏洞(只允许下载当前地图，只允许下载当前地图已缓存资源)
2. fullupdate 导致服务器卡顿或者群T漏洞
3. SV_ParseResourceList 中没有验证资源数组数量导致的服务器崩溃
4. SV_ParseConsistencyResponse 中没有检查资源上传长度导致服务器内存写入溢出漏洞
5. SV_ParseVoiceData 中无效的语音数据内容导致服务器弹出错误提示框后游戏服务器退出漏洞
6. 修复connect中包含..或\或者"或\"等字符导致的服务器崩溃漏洞
7.修复NET_GetLong函数中没有正确判断数据长度导致服务器数据溢出漏洞
8.修复Netchan_Validate函数中没有判断frag_length导致的服务器数据溢出漏洞
9.增加防止假人攻击 如果在5秒内连续连接服务器7次则踢出服务器，如果5秒内连续连接超过35次则封禁ip 2小时

参数控制(可以写在server.cfg或amxx.cfg)：
sv_allow_dlfile
0服务器不允许下载任何非当前缓存的文件
1服务器允许下载非当前地图中缓存的文件
此参数控制是否允许服务器提前下载地图

sv_kick_dlfile
0 不踢出下载了非当前缓存的文件的玩家
1 踢出下载了非当前缓存的文件的玩家


补丁应用于HLDS CS1.5 4111e版本

注：手雷炸服补丁是可选的，如果你插件修复过了那么就不需要再次修复了。

手雷防炸补丁:mp.dll